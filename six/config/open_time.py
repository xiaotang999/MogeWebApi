# Filename: config/open_time.py
import time

def time_pk10():
    """
    北京pk10 15个小时,5分钟一期,共179期 开奖时间 从 早上09:07:00 开始采集 到 晚上23:59:59结束采集
    最后一期 采集不到就算了
    """
    open_time = [
        "09:07:00","09:12:00","09:17:00","09:22:00","09:27:00","09:32:00","09:37:00","09:42:00","09:47:00","09:52:00","09:57:00","10:02:00","10:07:00","10:12:00","10:17:00","10:22:00","10:27:00","10:32:00","10:37:00","10:42:00","10:47:00","10:52:00","10:57:00","11:02:00","11:07:00","11:12:00","11:17:00","11:22:00","11:27:00","11:32:00","11:37:00","11:42:00","11:47:00","11:52:00","11:57:00","12:02:00","12:07:00","12:12:00","12:17:00","12:22:00","12:27:00","12:32:00","12:37:00","12:42:00","12:47:00","12:52:00","12:57:00","13:02:00","13:07:00","13:12:00","13:17:00","13:22:00","13:27:00","13:32:00","13:37:00","13:42:00","13:47:00","13:52:00","13:57:00","14:02:00","14:07:00","14:12:00","14:17:00","14:22:00","14:27:00","14:32:00","14:37:00","14:42:00","14:47:00","14:52:00","14:57:00","15:02:00","15:07:00","15:12:00","15:17:00","15:22:00","15:27:00","15:32:00","15:37:00","15:42:00","15:47:00","15:52:00","15:57:00","16:02:00","16:07:00","16:12:00","16:17:00","16:22:00","16:27:00","16:32:00","16:37:00","16:42:00","16:47:00","16:52:00","16:57:00","17:02:00","17:07:00","17:12:00","17:17:00","17:22:00","17:27:00","17:32:00","17:37:00","17:42:00","17:47:00","17:52:00","17:57:00","18:02:00","18:07:00","18:12:00","18:17:00","18:22:00","18:27:00","18:32:00","18:37:00","18:42:00","18:47:00","18:52:00","18:57:00","19:02:00","19:07:00","19:12:00","19:17:00","19:22:00","19:27:00","19:32:00","19:37:00","19:42:00","19:47:00","19:52:00","19:57:00","20:02:00","20:07:00","20:12:00","20:17:00","20:22:00","20:27:00","20:32:00","20:37:00","20:42:00","20:47:00","20:52:00","20:57:00","21:02:00","21:07:00","21:12:00","21:17:00","21:22:00","21:27:00","21:32:00","21:37:00","21:42:00","21:47:00","21:52:00","21:57:00","22:02:00","22:07:00","22:12:00","22:17:00","22:22:00","22:27:00","22:32:00","22:37:00","22:42:00","22:47:00","22:52:00","22:57:00","23:02:00","23:07:00","23:12:00","23:17:00","23:22:00","23:27:00","23:32:00","23:37:00","23:42:00","23:47:00","23:52:00","23:57:00","23:59:59"
    ]
    # 获取当前时间 跟 数组进行比较, 获取应该采集的期号
    now_time = time.asctime( time.localtime(time.time()) ) # Tue Nov 20 16:08:54 2018
    now_time_cuo = int(time.mktime(time.strptime(now_time,"%a %b %d %H:%M:%S %Y")))  # 1542701352 # 获取当前时间 
    # test - s
    # now_time_cuo = 1542729598
    # 23:59:58 - 1542729598 # 09:07:58 - 1542676078 # 01:07:58 - 1542647278
    # test - e
    change_time = time.strftime("%a %b %d x %Y", time.localtime()) # Tue Nov 20 x 2018 获取现在时间 方便组合上面的时间 进行转换时间戳比较
    # 初始化
    stops = False
    day_id = 1
    open_t = 1
    for i  in open_time:
        list_time = change_time.replace("x", i) # 改变list的时间和今日组合
        list_time_cuo = int(time.mktime(time.strptime(list_time, "%a %b %d %H:%M:%S %Y"))) # 转换程时间戳
        if stops: break # 如果已获取到 跳出循环
        day_id = open_time.index(i) #day_id等于list的位数
        # if day_id == 0: day_id = 179
        # ps: 如果当天小于09:07:00 应该采集昨天的 180期
        if now_time_cuo < list_time_cuo:
            stops = True # 退出遍历
            open_t = i
    # 
    if day_id == 0: # 判断 是否需要减去一天 时间戳加86400 24*60*60
        _nyr = time.strftime("%Y%m%d", time.localtime()) # 当前年月日
        _nyr = int(time.mktime(time.strptime(_nyr,"%Y%m%d"))) - 86400 # 转换时间戳 int
        day_id = 179
        day_id = time.strftime("%Y%m%d", time.localtime(_nyr))+str(day_id).zfill(3)
        # 如果小于09:07:00的第0期 采集昨日的179期
    else:
        day_id = time.strftime("%Y%m%d", time.localtime())+str(day_id).zfill(3)
    # 
    print( '<北京PK10> 应该采集 - 第 '+day_id+' 期 - 当前时间小于>>> '+open_t+' <<<' )


    info = [day_id,open_t]
    # print(info)
    return info